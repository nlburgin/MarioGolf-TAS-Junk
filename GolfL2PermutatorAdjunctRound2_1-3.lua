--adjunct script to the Golf Permutator script

--CSV output from the golf permutator script should be pasted into here
 array = {1,-26,28,60,50,2,-26,28,60,49,3,-26,28,60,48,4,-26,28,60,47,5,-26,28,60,46,6,-26,28,60,45,7,-26,28,60,44,8,-26,28,60,43,9,-26,28,60,42,10,-26,28,60,41,11,-26,28,60,40,12,-26,28,60,39,13,-26,28,60,38,14,-26,28,60,37,15,-26,28,60,36,16,-26,28,60,35,17,-26,28,60,34,18,-26,28,60,33,19,-26,28,60,32,20,-26,28,60,31,21,-26,28,60,30,22,-26,28,59,38,23,-26,28,59,36,24,-26,28,59,34,25,-28,30,60,50,26,-28,30,60,49,27,-28,30,60,48,28,-28,30,60,47,29,-28,30,60,46,30,-28,30,60,45,31,-28,30,60,44,32,-28,30,60,43,33,-28,30,60,42,34,-28,30,60,41,35,-28,30,60,40,36,-28,30,60,39,37,-28,30,60,38,38,-28,30,60,37,39,-28,30,60,36,40,-28,30,60,35,41,-28,30,60,34,42,-28,30,60,33,43,-28,30,60,32,44,-28,30,60,31,45,-28,30,60,30,46,-28,30,59,38,47,-28,30,59,36,48,-28,30,59,34,49,-30,32,60,50,50,-30,32,60,49,51,-30,32,60,48,52,-30,32,60,47,53,-30,32,60,46,54,-30,32,60,45,55,-30,32,60,44,56,-30,32,60,43,57,-30,32,60,42,58,-30,32,60,41,59,-30,32,60,40,60,-30,32,60,39,61,-30,32,60,38,62,-30,32,60,37,63,-30,32,60,36,64,-30,32,60,35,65,-30,32,60,34,66,-30,32,60,33,67,-30,32,60,32,68,-30,32,60,31,69,-30,32,60,30,70,-30,32,59,38,71,-30,32,59,36,72,-30,32,59,34,73,-32,34,60,50,74,-32,34,60,49,75,-32,34,60,48,76,-32,34,60,47,77,-32,34,60,46,78,-32,34,60,45,79,-32,34,60,44,80,-32,34,60,43,81,-32,34,60,42,82,-32,34,60,41,83,-32,34,60,40,84,-32,34,60,39,85,-32,34,60,38,86,-32,34,60,37,87,-32,34,60,36,88,-32,34,60,35,89,-32,34,60,34,90,-32,34,60,33,91,-32,34,60,32,92,-32,34,60,31,93,-32,34,60,30,94,-32,34,59,38,95,-32,34,59,36,96,-32,34,59,34,97,-34,36,60,50,98,-34,36,60,49,99,-34,36,60,48,100,-34,36,60,47,101,-34,36,60,46,102,-34,36,60,45,103,-34,36,60,44,104,-34,36,60,43,105,-34,36,60,42,106,-34,36,60,41,107,-34,36,60,40,108,-34,36,60,39,109,-34,36,60,38,110,-34,36,60,37,111,-34,36,60,36,112,-34,36,60,35,113,-34,36,60,34,114,-34,36,60,33,115,-34,36,60,32,116,-34,36,60,31,117,-34,36,60,30,118,-34,36,59,38,119,-34,36,59,36,120,-34,36,59,34,121,-36,38,60,50,122,-36,38,60,49,123,-36,38,60,48,124,-36,38,60,47,125,-36,38,60,46,126,-36,38,60,45,127,-36,38,60,44,128,-36,38,60,43,129,-36,38,60,42,130,-36,38,60,41,131,-36,38,60,40,132,-36,38,60,39,133,-36,38,60,38,134,-36,38,60,37,135,-36,38,60,36,136,-36,38,60,35,137,-36,38,60,34,138,-36,38,60,33,139,-36,38,60,32,140,-36,38,60,31,141,-36,38,60,30,142,-36,38,59,38,143,-36,38,59,36,144,-36,38,59,34,145,-38,40,60,50,146,-38,40,60,49,147,-38,40,60,48,148,-38,40,60,47,149,-38,40,60,46,150,-38,40,60,45,151,-38,40,60,44,152,-38,40,60,43,153,-38,40,60,42,154,-38,40,60,41,155,-38,40,60,40,156,-38,40,60,39,157,-38,40,60,38,158,-38,40,60,37,159,-38,40,60,36,160,-38,40,60,35,161,-38,40,60,34,162,-38,40,60,33,163,-38,40,60,32,164,-38,40,60,31,165,-38,40,60,30,166,-38,40,59,38,167,-38,40,59,36,168,-38,40,59,34,169,-40,42,60,50,170,-40,42,60,49,171,-40,42,60,48,172,-40,42,60,47,173,-40,42,60,46,174,-40,42,60,45,175,-40,42,60,44,176,-40,42,60,43,177,-40,42,60,42,178,-40,42,60,41,179,-40,42,60,40,180,-40,42,60,39,181,-40,42,60,38,182,-40,42,60,37,183,-40,42,60,36,184,-40,42,60,35,185,-40,42,60,34,186,-40,42,60,33,187,-40,42,60,32,188,-40,42,60,31,189,-40,42,60,30,190,-40,42,59,38,191,-40,42,59,36,192,-40,42,59,34,193,-42,44,60,50,194,-42,44,60,49,195,-42,44,60,48,196,-42,44,60,47,197,-42,44,60,46,198,-42,44,60,45,199,-42,44,60,44,200,-42,44,60,43,201,-42,44,60,42,202,-42,44,60,41,203,-42,44,60,40,204,-42,44,60,39,205,-42,44,60,38,206,-42,44,60,37,207,-42,44,60,36,208,-42,44,60,35,209,-42,44,60,34,210,-42,44,60,33,211,-42,44,60,32,212,-42,44,60,31,213,-42,44,60,30,214,-42,44,59,38,215,-42,44,59,36,216,-42,44,59,34,217,-44,46,60,50,218,-44,46,60,49,219,-44,46,60,48,220,-44,46,60,47,221,-44,46,60,46,222,-44,46,60,45,223,-44,46,60,44,224,-44,46,60,43,225,-44,46,60,42,226,-44,46,60,41,227,-44,46,60,40,228,-44,46,60,39,229,-44,46,60,38,230,-44,46,60,37,231,-44,46,60,36,232,-44,46,60,35,233,-44,46,60,34,234,-44,46,60,33,235,-44,46,60,32,236,-44,46,60,31,237,-44,46,60,30,238,-44,46,59,38,239,-44,46,59,36,240,-44,46,59,34,241,-46,48,60,50,242,-46,48,60,49,243,-46,48,60,48,244,-46,48,60,47,245,-46,48,60,46,246,-46,48,60,45,247,-46,48,60,44,248,-46,48,60,43,249,-46,48,60,42,250,-46,48,60,41,251,-46,48,60,40,252,-46,48,60,39,253,-46,48,60,38,254,-46,48,60,37,255,-46,48,60,36,256,-46,48,60,35,257,-46,48,60,34,258,-46,48,60,33,259,-46,48,60,32,260,-46,48,60,31,261,-46,48,60,30,262,-46,48,59,38,263,-46,48,59,36,264,-46,48,59,34,265,-48,50,60,50,266,-48,50,60,49,267,-48,50,60,48,268,-48,50,60,47,269,-48,50,60,46,270,-48,50,60,45,271,-48,50,60,44,272,-48,50,60,43,273,-48,50,60,42,274,-48,50,60,41,275,-48,50,60,40,276,-48,50,60,39,277,-48,50,60,38,278,-48,50,60,37,279,-48,50,60,36,280,-48,50,60,35,281,-48,50,60,34,282,-48,50,60,33,283,-48,50,60,32,284,-48,50,60,31,285,-48,50,60,30,286,-48,50,59,38,287,-48,50,59,36,288,-48,50,59,34,289,-50,52,60,50,290,-50,52,60,49,291,-50,52,60,48,292,-50,52,60,47,293,-50,52,60,46,294,-50,52,60,45,295,-50,52,60,44,296,-50,52,60,43,297,-50,52,60,42,298,-50,52,60,41,299,-50,52,60,40,300,-50,52,60,39,301,-50,52,60,38,302,-50,52,60,37,303,-50,52,60,36,304,-50,52,60,35,305,-50,52,60,34,306,-50,52,60,33,307,-50,52,60,32,308,-50,52,60,31,309,-50,52,60,30,310,-50,52,59,38,311,-50,52,59,36,312,-50,52,59,34,313,-52,54,60,50,314,-52,54,60,49,315,-52,54,60,48,316,-52,54,60,47,317,-52,54,60,46,318,-52,54,60,45,319,-52,54,60,44,320,-52,54,60,43,321,-52,54,60,42,322,-52,54,60,41,323,-52,54,60,40,324,-52,54,60,39,325,-52,54,60,38,326,-52,54,60,37,327,-52,54,60,36,328,-52,54,60,35,329,-52,54,60,34,330,-52,54,60,33,331,-52,54,60,32,332,-52,54,60,31,333,-52,54,60,30,334,-52,54,59,38,335,-52,54,59,36,336,-52,54,59,34,337,-54,56,60,50,338,-54,56,60,49,339,-54,56,60,48,340,-54,56,60,47,341,-54,56,60,46,342,-54,56,60,45,343,-54,56,60,44,344,-54,56,60,43,345,-54,56,60,42,346,-54,56,60,41,347,-54,56,60,40,348,-54,56,60,39,349,-54,56,60,38,350,-54,56,60,37,351,-54,56,60,36,352,-54,56,60,35,353,-54,56,60,34,354,-54,56,60,33,355,-54,56,60,32,356,-54,56,60,31,357,-54,56,60,30,358,-54,56,59,38,359,-54,56,59,36,360,-54,56,59,34,361,-56,58,60,50,362,-56,58,60,49,363,-56,58,60,48,364,-56,58,60,47,365,-56,58,60,46,366,-56,58,60,45,367,-56,58,60,44,368,-56,58,60,43,369,-56,58,60,42,370,-56,58,60,41,371,-56,58,60,40,372,-56,58,60,39,373,-56,58,60,38,374,-56,58,60,37,375,-56,58,60,36,376,-56,58,60,35,377,-56,58,60,34,378,-56,58,60,33,379,-56,58,60,32,380,-56,58,60,31,381,-56,58,60,30,382,-56,58,59,38,383,-56,58,59,36,384,-56,58,59,34,385,-58,60,60,50,386,-58,60,60,49,387,-58,60,60,48,388,-58,60,60,47,389,-58,60,60,46,390,-58,60,60,45,391,-58,60,60,44,392,-58,60,60,43,393,-58,60,60,42,394,-58,60,60,41,395,-58,60,60,40,396,-58,60,60,39,397,-58,60,60,38,398,-58,60,60,37,399,-58,60,60,36,400,-58,60,60,35,401,-58,60,60,34,402,-58,60,60,33,403,-58,60,60,32,404,-58,60,60,31,405,-58,60,60,30,406,-58,60,59,38,407,-58,60,59,36,408,-58,60,59,34};

local teeFrame = 4250;
local strikeFrame = 4371;
local testFrame = 5026;

local teeSlot = 9;

local i = 1;

while array[i] ~= nil
do
  local solution = array[i];
  local aim = array[i+1];
  local aim2 = array[i+2];
  local strikeX = array[i+3];
  local strikeY = array[i+4];
  
  savestate.loadslot(teeSlot);  
  tastudio.submitanalogchange(teeFrame,"P1 X Axis",aim);
  tastudio.submitanalogchange(teeFrame - 2,"P1 X Axis",aim2);
  tastudio.submitanalogchange(strikeFrame,"P1 Y Axis",strikeY);
  tastudio.submitanalogchange(strikeFrame,"P1 X Axis",strikeX);
  tastudio.applyinputchanges();
  
  while (emu.framecount() < testFrame)
  do
    emu.frameadvance();
  end
  
  while (emu.framecount() < testFrame + 10 )
  do
    client.screenshot(string.format("W:\\Iterations\\Iteration %u-%u.png",solution,emu.framecount()));
    emu.frameadvance();
    emu.frameadvance();
  end
  print(solution);
  i = i + 5;
end
client.pause();